<!DOCTYPE html>
<html lang="%lang;">
<head>
%define;title()
[
en: Cartography
fr: Cartographie
] -
  %apply;a_of_b_gr_eq_lev%with;
    [descendants]%nn;
  %and;
    %if;(public_name != "")%public_name;%else;%first_name;%end;
    %if;(qualifier != "") %qualifier;%end;
    %sp;%surname;
  %end;
%end;
  <title>%apply;title()</title>
  <meta charset="UTF-8" />
  %include.css;
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
    integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
    crossorigin="" />
  <style>
    html { height: 100%% }
    body { height: 100%%; margin: 0; padding: 0 }
    #EmplacementDeMaCarte { height: 84%% }
    .right{ float: right; }
  </style>
</head>

%define;tothegen(xx)
  [*to the %s generation:::xx]%nn;
%end;

%define;togen(xx)
  %if;(xx = 0)[*specify::generation/generations]0%nn;
  %elseif;(xx = 1)[*to the children]%nn;
  %elseif;(xx = 2)[*to the grandchildren]%nn;
  %elseif;(xx = 3)[*to the great-grandchildren]%nn;
  %else;
    %apply;tothegen%with;
      %apply;nth([nth (generation)], xx)
    %end;
  %end;
%end;

%define;somebody_long_info(xx)
  %if;(xx.has_birth_date and xx.has_birth_place)
    { key: "%xx.birth_place;", annee: "%xx.birth_date.year;" },
  %end;
  %if;xx.is_dead;
    %if;(xx.has_death_date and xx.has_death_place)
      { key: "%xx.death_place;", annee: "%xx.death_date.year;" },
    %end;
  %end;
%end;
%define;descendants_by_list(xx, curlev, maxlev, famlev)
  %apply;somebody_long_info("xx")
  %foreach;xx.family;
    %if;(on_marriage_date != "" and marriage_place != "")
      { key: "%marriage_place;", annee: "%marriage_date.year;" },
    %end;
    %apply;somebody_long_info("spouse")
    %if;(curlev < maxlev)
      %if;(family.desc_level < famlev)
      %elseif;(family.desc_level > famlev)
      %elseif;has_children;
        %foreach;child;
          %apply;descendants_by_list("child", curlev+1, maxlev, famlev+1)
        %end;
      %end;
    %end;
  %end;
%end;
%define;by_list(xx)
  %apply;descendants_by_list("self", 0, xx, 0)%nl;
%end;

<body onload="initCarto( '%bvar.var_cartol;' );">

<div class="container-fluid">
%include;home
<h1>%apply;title()</h1>

<p>%apply;togen(evar.v).</p>

<div><b>Légende :</b> nombre d'événement(s)
<img src="%bvar.var_cartol;/icone_0.png" />1
<span id="bloc_leg1"><img src="%bvar.var_cartol;/icone_1.png" /><span id="leg1"></span></span>
<span id="bloc_leg2"><img src="%bvar.var_cartol;/icone_2.png" /><span id="leg2"></span></span>
<span id="bloc_leg3"><img src="%bvar.var_cartol;/icone_3.png" /><span id="leg3"></span></span>
<span id="bloc_leg4"><img src="%bvar.var_cartol;/icone_4.png" /><span id="leg4"></span></span>

<span id="nbr"></span>
<a class="right" href="#" onclick="resetZoom();"><img src="%bvar.var_cartol;/reset.png"/></a>
</div>
</div>

<div id="EmplacementDeMaCarte"></div>

<div class="container-fluid">
%include;trl
%include;copyr
</div>

<script>
// tableau constuit par GeneWeb
var tableauLieux = %[
  %apply;by_list(evar.v)
  {}
];

var prefix="%bvar.var_cartol;";
</script>
%include;js
<script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
  integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
  crossorigin=""></script>
<script src="%bvar.var_cartol;/geoloc2.js"></script>
<script src="%bvar.var_cartol;/check2.js"></script>
</body>
</html>
